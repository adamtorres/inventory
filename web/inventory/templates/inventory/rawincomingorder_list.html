{% extends "base.html" %}
{% load humanize %}

{% block title %}Order List{% endblock %}

{% block styles %}
<style>
#order-list tr {
}
#order-list td {
    margin: 0;
    border-top: black solid 1px;
    border-right: lightgray solid 1px;
}
#order-list tr:last-child td {
    border-bottom: black solid 1px;
}
#order-list tr[data-detail-url] {
    cursor: pointer;
}
.number-cell {
    text-align: right;
}
.dollar-cell {
    text-align: right;
}
</style>
{% endblock %}

{% block content %}
    <ul>
    <li><a href="{% url "inventory:rawincomingorder_list" %}?reset">reset filters</a></li>
    </ul>
    <table id="order-list">
    <thead>
    <tr>
        <th>source</th>
        <th>department</th>
        <th class="number-cell">customer number</th>
        <th class="number-cell">order number</th>
        <th>po text</th>
        <th>order comment</th>
        <th class="number-cell">order date</th>
        <th class="number-cell">delivery date</th>
        <th class="dollar-cell">total price</th>
        <th class="number-cell">total packs</th>
        <th class="number-cell">item count</th>
    </tr>
    </thead>
    <tbody>
    {% for order in object_list %}
        <tr data-detail-url="{% url "inventory:rawincomingorder_detail" pk=order.item_ids.0 %}">
            <td>{{ order.source }}</td>
            <td>{{ order.department }}</td>
            <td class="number-cell">{{ order.customer_number }}</td>
            <td class="number-cell">{{ order.order_number }}</td>
            <td>{{ order.po_text }}</td>
            <td>{{ order.order_comment }}</td>
            <td class="number-cell">{{ order.order_date|default_if_none:"" }}</td>
            <td class="number-cell">{{ order.delivery_date }}</td>
            <td class="dollar-cell">{{ order.total_price|intcomma|floatformat:2 }}</td>
            <td class="number-cell">{{ order.total_packs|intcomma|floatformat }}</td>
            <td class="number-cell">{{ order.item_count }}</td>
        </tr>
    {% endfor %}
    </tbody>
    </table>

{% endblock %}

{% block body_scripts %}
<script type="text/javascript">
// Get the table that contains all we want to work with.
var el = document.getElementById('order-list');
// Link all of the other cells in a row to take the user to the detail page.
var link_trs = el.querySelectorAll('[data-detail-url]');
for (var ltd_i=0, ltd_len=link_trs.length; ltd_i<ltd_len; ltd_i++) {
    link_trs[ltd_i].onclick = function() {
        window.location = this.attributes["data-detail-url"].value;
    }
}
</script>
{% endblock %}
